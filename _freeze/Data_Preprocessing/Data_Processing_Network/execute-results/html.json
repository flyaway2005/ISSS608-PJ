{
  "hash": "a160772c828e8d46d58b309d52ad3c43",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Preprocessing for Network Module\"\nauthor: \"Cathy Chu\"\ndate-modified: \"last-modified\" \nexecute:\n  echo: true \n  eval: true \n  warning: false \n  freeze: true  \n---\n\n\n\n\n## Overview\n\nThis document outlines the data preprocessing steps for the Network Insights module. The process involves cleaning and transforming government procurement data from GeBIZ, incorporating tender categories from Tender Analysis Module, and preparing the data for network visualisation.\n\n## Data Import and Exploration\n\n### Load Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, dplyr, lubridate, tidyr, knitr)\n```\n:::\n\n\n\n\n### Import Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGeBiz_csv <- read_csv(\"../data/GovernmentProcurementviaGeBIZ.csv\")\nlabel_data <- read_csv(\"../data/Labeled_Tenders.csv\")\n```\n:::\n\n\n\n\n### Dataset Overview\n\n#### **Government Procurement Dataset**\nThe dataset has 18,638 rows and 7 columns. The 7 columns are *tender_no, tender_description, agency, award_date, tender_detail_status, supplier_name, and awarded_amt.* Among these variables, awarded_amt is numeric type while the rest are all character type.\n\nNote that the award_date is also character_type. We will need to transform the type to date type and do further processing to meet Network Visualisation's needs.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(GeBiz_csv)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 18,638\nColumns: 7\n$ tender_no            <chr> \"ACR000ETT18300010\", \"ACR000ETT18300011\", \"ACR000…\n$ tender_description   <chr> \"SUPPLY, DESIGN, DEVELOPMENT, CUSTOMIZATION, DELI…\n$ agency               <chr> \"Accounting And Corporate Regulatory Authority\", …\n$ award_date           <chr> \"11/6/2019\", \"10/5/2019\", \"30/4/2019\", \"29/8/2019…\n$ tender_detail_status <chr> \"Awarded to Suppliers\", \"Awarded to No Suppliers\"…\n$ supplier_name        <chr> \"AZAAS PTE. LTD.\", \"Unknown\", \"ACCENTURE SG SERVI…\n$ awarded_amt          <dbl> 2305880.0, 0.0, 2035000.0, 30700373.9, 178800.0, …\n```\n\n\n:::\n:::\n\n\n\n\n#### **Derived Dataset**\nThe dataset derived from Text Analysis module has 24,438 rows and 15 columns. We noted that the rows are more than the original dataset, so it means that during machine learning process, some of the data was duplicated. Since what we want is to join the LDA_category (tender type) and CATEGORY / SUBCAT (agency type), the duplicated data does not affect us.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(label_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 24,438\nColumns: 15\n$ tender_no            <chr> \"ACR000ETT18300010\", \"ACR000ETT18300011\", \"ACR000…\n$ tender_description   <chr> \"SUPPLY, DESIGN, DEVELOPMENT, CUSTOMIZATION, DELI…\n$ agency               <chr> \"Accounting And Corporate Regulatory Authority\", …\n$ award_date           <date> 2019-06-11, 2019-05-10, 2019-04-30, 2019-08-29, …\n$ tender_detail_status <chr> \"Awarded to Suppliers\", \"Awarded to No Suppliers\"…\n$ supplier_name        <chr> \"AZAAS PTE. LTD.\", \"Unknown\", \"ACCENTURE SG SERVI…\n$ awarded_amt          <dbl> 2305880.0, 0.0, 2035000.0, 30700373.9, 178800.0, …\n$ agency_clean         <chr> \"accounting and corporate regulatory authority\", …\n$ NAME                 <chr> \"ACCOUNTING AND CORPORATE REGULATORY AUTHORITY (A…\n$ CATEGORY             <chr> \"STATUTORY_BOARDS\", \"STATUTORY_BOARDS\", \"STATUTOR…\n$ SUBCAT               <chr> \"STATUTORY_BOARDS\", \"STATUTORY_BOARDS\", \"STATUTOR…\n$ tender_clean         <chr> \"design development customization  installation t…\n$ topic                <dbl> 1, 1, 5, 1, 4, 2, 6, 6, 6, 2, 1, 1, 3, 4, 3, 6, 6…\n$ gamma                <dbl> 0.6590389, 0.7189741, 0.7862579, 0.9379768, 0.399…\n$ LDA_Category         <chr> \"General Procurement - Goods\", \"General Procureme…\n```\n\n\n:::\n:::\n\n\n\n\n## Data Processing\n\n### Data Cleaning\n\nBefore joining the datasets, we conducted a quick exploratory data analysis to determine whether the data would need further processing before or after merging.\n\nOur analysis revealed that some entries have \"unknown\" listed as the supplier_name with zero values in awarded_amt. These represent tenders that failed to receive a successful bid. We will exclude these entries from our network analysis.\n\nDuring data wrangling, we will:\n\n-   Convert dates to proper date type format\n\n-   Filter out entries with no awarded tenders\n\n-   Add columns for Year, Month, and Quarter to facilitate date range selection and temporal analysis\n\nOur EDA found no missing values, so no additional handling is needed for null values.\n\nThe code below implements these data preparation steps.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n#filter out Unknown value (no tender awarded)\nGeBiz_full <- GeBiz_csv %>%\n  filter(supplier_name != \"Unknown\")\n\n# Convert dates\nGeBiz_full$award_date <- as.Date(GeBiz_full$award_date, , format = \"%d/%m/%Y\")\n\n# Remove white space if have.\nGeBiz_full$agency <- trimws(GeBiz_full$agency)\nGeBiz_full$supplier_name <- trimws(GeBiz_full$supplier_name)\n\n# Add year and month columns for time-based filtering\nGeBiz_addtime <- GeBiz_full %>%\n  mutate(award_year = format(award_date, \"%Y\"),\n         month = format(award_date, \"%m\"),\n         year_month = format(award_date, \"%Y-%m\"),\n         quarter = quarters(award_date))\n#write_csv(GeBiz_addtime, \"GeBiz_add_y_m.csv\")\nkable(head(GeBiz_addtime))\n```\n\n::: {.cell-output-display}\n\n\n|tender_no         |tender_description                                                                                                                                                                                         |agency                                        |award_date |tender_detail_status |supplier_name                                      | awarded_amt|award_year |month |year_month |quarter |\n|:-----------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------|:----------|:--------------------|:--------------------------------------------------|-----------:|:----------|:-----|:----------|:-------|\n|ACR000ETT18300010 |SUPPLY, DESIGN, DEVELOPMENT, CUSTOMIZATION, DELIVERY, INSTALLATION, TESTING, COMMISSIONING AND MAINTENANCE OF A VARIABLE CAPITAL COMPANIES (VCC) SYSTEM FOR ACCOUNTING AND CORPORATE REGULARTORY AUTHORITY |Accounting And Corporate Regulatory Authority |2019-06-11 |Awarded to Suppliers |AZAAS PTE. LTD.                                    |     2305880|2019       |06    |2019-06    |Q2      |\n|ACR000ETT19300001 |PROVISION OF CONSULTANCY SERVICES FOR STRATEGIC BUSINESS PROCESSES RE-ENGINEERING (SBPR) AND ACRA'S IT INFRASTRUCTURE                                                                                      |Accounting And Corporate Regulatory Authority |2019-04-30 |Awarded to Suppliers |ACCENTURE SG SERVICES PTE. LTD.                    |     2035000|2019       |04    |2019-04    |Q2      |\n|ACR000ETT19300002 |SUPPLY, DELIVERY, DESIGN, CUSTOMISATION, INSTALLATION, CONFIGURATION, TESTING, COMMISSIONING OF A FULLY OPERATIONAL BIZFILE+ WITH AN OPTION FOR MAINTENANCE                                                |Accounting And Corporate Regulatory Authority |2019-08-29 |Awarded to Suppliers |TECH MAHINDRA LIMITED (SINGAPORE BRANCH)           |    30700374|2019       |08    |2019-08    |Q3      |\n|ACR000ETT19300003 |PROVISION OF MEDIA MONITORING SERVICES FOR A PERIOD OF TWO YEARS WITH OPTION TO EXTEND FOR UP TO ONE YEAR                                                                                                  |Accounting And Corporate Regulatory Authority |2019-08-06 |Awarded to Suppliers |INSIGHTMATRIX                                      |      178800|2019       |08    |2019-08    |Q3      |\n|ACR000ETT19300004 |INVITATION TO TENDER FOR THE PROVISION OF CALL CENTRE SERVICES FOR ACCOUNTING AND CORPORATE REGULATORY AUTHORITY FOR A PERIOD OF 3 YEARS WITH OPTION OF UP TO 2 EXTENSIONS OF 2 YEARS EACH                 |Accounting And Corporate Regulatory Authority |2019-11-05 |Awarded to Suppliers |TDCX (SG) PTE. LTD.                                |     8566831|2019       |11    |2019-11    |Q4      |\n|ACR000ETT20300002 |INVITATION TO TENDER FOR THE PROVISION OF SERVICES FOR COMPLIANCE REVIEW PROGRAMME                                                                                                                         |Accounting And Corporate Regulatory Authority |2020-11-10 |Awarded by Items     |DELOITTE & TOUCHE ENTERPRISE RISK SERVICES PTE LTD |      285000|2020       |11    |2020-11    |Q4      |\n\n\n:::\n:::\n\n\n\n\n::::: goals\n::: goals-header\nNote\n:::\n\n::: goals-container\n-   The data now has 17,855 rows and 11 columns. Less rows from the original dataset because the unknown entries have been removed.\n-   Now *award_date* has been converted to *date* type, and the year, month, and quarter have been added to the dataset.\n-   In the code above, we managed to save the data as a csv file *eBiz_add_y_m.csv.* This is so when we need further processing during app development, the process is quicker and less computation heavy.\n:::\n:::::\n\n### Data Joining\n\nIn this step, we will join the datasets to incorporate derived columns such as tender category (from machine learning) and agency type (from government definitions) for use in our Network Analysis.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Match LDA & agency type\nnetwork_w_type_data <- GeBiz_addtime %>%\n\n  mutate(row_id = row_number()) %>%\n  mutate(tender_cat = label_data$LDA_Category[match(tender_description,\n                                                    label_data$tender_description)]) %>%\n  mutate(agency_type = label_data$SUBCAT[match(agency,\n                                               label_data$agency)]) %>%\n  select(-row_id)\n\nkable(head(network_w_type_data))\n```\n\n::: {.cell-output-display}\n\n\n|tender_no         |tender_description                                                                                                                                                                                         |agency                                        |award_date |tender_detail_status |supplier_name                                      | awarded_amt|award_year |month |year_month |quarter |tender_cat                         |agency_type      |\n|:-----------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------|:----------|:--------------------|:--------------------------------------------------|-----------:|:----------|:-----|:----------|:-------|:----------------------------------|:----------------|\n|ACR000ETT18300010 |SUPPLY, DESIGN, DEVELOPMENT, CUSTOMIZATION, DELIVERY, INSTALLATION, TESTING, COMMISSIONING AND MAINTENANCE OF A VARIABLE CAPITAL COMPANIES (VCC) SYSTEM FOR ACCOUNTING AND CORPORATE REGULARTORY AUTHORITY |Accounting And Corporate Regulatory Authority |2019-06-11 |Awarded to Suppliers |AZAAS PTE. LTD.                                    |     2305880|2019       |06    |2019-06    |Q2      |General Procurement - Goods        |STATUTORY_BOARDS |\n|ACR000ETT19300001 |PROVISION OF CONSULTANCY SERVICES FOR STRATEGIC BUSINESS PROCESSES RE-ENGINEERING (SBPR) AND ACRA'S IT INFRASTRUCTURE                                                                                      |Accounting And Corporate Regulatory Authority |2019-04-30 |Awarded to Suppliers |ACCENTURE SG SERVICES PTE. LTD.                    |     2035000|2019       |04    |2019-04    |Q2      |Engineering Procurement - EPC      |STATUTORY_BOARDS |\n|ACR000ETT19300002 |SUPPLY, DELIVERY, DESIGN, CUSTOMISATION, INSTALLATION, CONFIGURATION, TESTING, COMMISSIONING OF A FULLY OPERATIONAL BIZFILE+ WITH AN OPTION FOR MAINTENANCE                                                |Accounting And Corporate Regulatory Authority |2019-08-29 |Awarded to Suppliers |TECH MAHINDRA LIMITED (SINGAPORE BRANCH)           |    30700374|2019       |08    |2019-08    |Q3      |General Procurement - Goods        |STATUTORY_BOARDS |\n|ACR000ETT19300003 |PROVISION OF MEDIA MONITORING SERVICES FOR A PERIOD OF TWO YEARS WITH OPTION TO EXTEND FOR UP TO ONE YEAR                                                                                                  |Accounting And Corporate Regulatory Authority |2019-08-06 |Awarded to Suppliers |INSIGHTMATRIX                                      |      178800|2019       |08    |2019-08    |Q3      |Engineering Procurement - Services |STATUTORY_BOARDS |\n|ACR000ETT19300004 |INVITATION TO TENDER FOR THE PROVISION OF CALL CENTRE SERVICES FOR ACCOUNTING AND CORPORATE REGULATORY AUTHORITY FOR A PERIOD OF 3 YEARS WITH OPTION OF UP TO 2 EXTENSIONS OF 2 YEARS EACH                 |Accounting And Corporate Regulatory Authority |2019-11-05 |Awarded to Suppliers |TDCX (SG) PTE. LTD.                                |     8566831|2019       |11    |2019-11    |Q4      |General Procurement - Services     |STATUTORY_BOARDS |\n|ACR000ETT20300002 |INVITATION TO TENDER FOR THE PROVISION OF SERVICES FOR COMPLIANCE REVIEW PROGRAMME                                                                                                                         |Accounting And Corporate Regulatory Authority |2020-11-10 |Awarded by Items     |DELOITTE & TOUCHE ENTERPRISE RISK SERVICES PTE LTD |      285000|2020       |11    |2020-11    |Q4      |PPP Procurement - DBO              |STATUTORY_BOARDS |\n\n\n:::\n:::\n\n\n\n\n### Network Data Preparation\n\nNow, we will create an RDS file for use in the Network module. In the code below, we convert relevant time fields to date or numeric types. We assign unique IDs and types to both agencies and suppliers. We then create edges to define the relationships between agencies and suppliers, aggregating multiple tenders into single connections.\n\n#### 1 Clean and Format Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# remove unknown suppliers and whitespace\nGeBiz_clean <- GeBiz_csv %>%\n  filter(supplier_name != \"Unknown\") %>%\n  mutate(\n    # Proper date conversion with error handling\n    award_date = as.Date(award_date, format = \"%d/%m/%Y\"),\n    # Clean whitespace\n    agency = trimws(agency),\n    supplier_name = trimws(supplier_name)\n  ) \n```\n:::\n\n\n\n\n#### 2 Add Time Components\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nGeBiz_enhanced <- GeBiz_clean %>%\n  mutate(\n    # Add time components as numeric values from the start\n    award_year = as.numeric(format(award_date, \"%Y\")),\n    month_num = as.numeric(format(award_date, \"%m\")),\n    # Create month_index for filtering (YYYYMM format)\n    month_index = award_year * 12 + month_num,\n    # Create display formats\n    month_name = month.name[month_num],\n    year_month = paste0(award_year, \"-\", sprintf(\"%02d\", month_num)),\n    quarter = quarters(award_date)\n  )\n```\n:::\n\n\n\n\n#### 3 Add Categories and Labels\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nnetwork_labeled <- GeBiz_enhanced %>%\n  # Add tender categories and agency types\n  left_join(\n    label_data %>% select(tender_description, LDA_Category),\n    by = \"tender_description\"\n  ) %>%\n  left_join(\n    label_data %>% select(agency, SUBCAT) %>% distinct(),\n    by = \"agency\"\n  ) %>%\n  # Rename for clarity\n  rename(\n    tender_cat = LDA_Category,\n    agency_type = SUBCAT\n  ) %>%\n  # Handle potential NAs for categories\n  mutate(\n    tender_cat = if_else(is.na(tender_cat), \"Uncategorized\", tender_cat),\n    agency_type = if_else(is.na(agency_type), \"Unspecified\", agency_type)\n  )\n```\n:::\n\n\n\n\n### Create Network Dataset\n\n#### 1 Create Node Dataset\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Create Node Dataset -----\n# First aggregate metrics for agencies and suppliers\nagency_metrics <- network_labeled %>%\n  group_by(agency) %>%\n  summarise(\n    total_contracts = n(),\n    total_award_amount = sum(awarded_amt, na.rm = TRUE),\n    first_contract_date = min(award_date, na.rm = TRUE),\n    last_contract_date = max(award_date, na.rm = TRUE),\n    agency_type = first(agency_type)\n  )\n\nsupplier_metrics <- network_labeled %>%\n  group_by(supplier_name) %>%\n  summarise(\n    total_contracts = n(),\n    total_award_amount = sum(awarded_amt, na.rm = TRUE),\n    first_contract_date = min(award_date, na.rm = TRUE),\n    last_contract_date = max(award_date, na.rm = TRUE)\n  )\n\n# Create agency nodes\nagency_nodes <- agency_metrics %>%\n  mutate(\n    name = agency,\n    type = \"agency\",\n    id = paste0(\"agency_\", row_number())\n  ) %>%\n  select(id, name, type, agency_type, total_contracts, total_award_amount, \n         first_contract_date, last_contract_date)\n\n# Create supplier nodes\nsupplier_nodes <- supplier_metrics %>%\n  mutate(\n    name = supplier_name,\n    type = \"supplier\",\n    id = paste0(\"supplier_\", row_number())\n  ) %>%\n  select(id, name, type, total_contracts, total_award_amount, \n         first_contract_date, last_contract_date)\n\n# Combine nodes\nnodes_df <- bind_rows(agency_nodes, supplier_nodes)\n\n# Create a lookup table for IDs\nagency_lookup <- agency_nodes %>% select(agency = name, agency_id = id)\nsupplier_lookup <- supplier_nodes %>% select(supplier_name = name, supplier_id = id)\n\nkable(head(nodes_df,3))\n```\n\n::: {.cell-output-display}\n\n\n|id       |name                                          |type   |agency_type      | total_contracts| total_award_amount|first_contract_date |last_contract_date |\n|:--------|:---------------------------------------------|:------|:----------------|---------------:|------------------:|:-------------------|:------------------|\n|agency_1 |Accounting And Corporate Regulatory Authority |agency |STATUTORY_BOARDS |              29|        171409240.7|2019-04-30          |2024-01-18         |\n|agency_2 |Agency for Science, Technology and Research   |agency |STATUTORY_BOARDS |            2521|       1172727607.7|2019-04-05          |2024-03-12         |\n|agency_3 |Agri-food and Veterinary Authority            |agency |STATUTORY_BOARDS |               3|           582362.8|2019-04-05          |2019-06-25         |\n\n\n:::\n:::\n\n\n\n\n#### 2 Create Edge Dataset\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Create Edge Dataset -----\nedges_df <- network_labeled %>%\n  # Join with lookup tables to get IDs\n  left_join(agency_lookup, by = \"agency\") %>%\n  left_join(supplier_lookup, by = \"supplier_name\") %>%\n  mutate(\n    from_id = agency_id,\n    to_id = supplier_id\n  ) %>%\n  # Each row is one contract\n  mutate(\n    total_contracts = 1,\n    total_award_amount = awarded_amt\n  ) %>%\n  # Select final fields for edges\n  select(\n    agency, supplier_name, from_id, to_id, tender_cat, agency_type,\n    total_contracts, total_award_amount, award_date, award_year, \n    month_num, month_index\n  )\nkable(head(edges_df,3))\n```\n\n::: {.cell-output-display}\n\n\n|agency                                        |supplier_name                            |from_id  |to_id         |tender_cat                    |agency_type      | total_contracts| total_award_amount|award_date | award_year| month_num| month_index|\n|:---------------------------------------------|:----------------------------------------|:--------|:-------------|:-----------------------------|:----------------|---------------:|------------------:|:----------|----------:|---------:|-----------:|\n|Accounting And Corporate Regulatory Authority |AZAAS PTE. LTD.                          |agency_1 |supplier_613  |General Procurement - Goods   |STATUTORY_BOARDS |               1|            2305880|2019-06-11 |       2019|         6|       24234|\n|Accounting And Corporate Regulatory Authority |ACCENTURE SG SERVICES PTE. LTD.          |agency_1 |supplier_103  |Engineering Procurement - EPC |STATUTORY_BOARDS |               1|            2035000|2019-04-30 |       2019|         4|       24232|\n|Accounting And Corporate Regulatory Authority |TECH MAHINDRA LIMITED (SINGAPORE BRANCH) |agency_1 |supplier_5377 |General Procurement - Goods   |STATUTORY_BOARDS |               1|           30700374|2019-08-29 |       2019|         8|       24236|\n\n\n:::\n:::\n\n\n\n\n#### 3 Create Monthly Edges Dataset\nThe monthly edges dataset is created for Network Overview to compute fast as date range is selected.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# monthly aggregated edges\nmonthly_edges_df <- network_labeled %>%\n  # Add IDs\n  left_join(agency_lookup, by = \"agency\") %>%\n  left_join(supplier_lookup, by = \"supplier_name\") %>%\n  # Group by agency, supplier and month\n  group_by(agency, supplier_name, agency_id, supplier_id, tender_cat, agency_type, month_index) %>%\n  summarise(\n    total_contracts = n(),\n    total_award_amount = sum(awarded_amt, na.rm = TRUE),\n    award_year = first(award_year),\n    month_num = first(month_num),\n    .groups = \"drop\"\n  )\nkable(head(monthly_edges_df,3))\n```\n\n::: {.cell-output-display}\n\n\n|agency                                        |supplier_name                   |agency_id |supplier_id  |tender_cat                    |agency_type      | month_index| total_contracts| total_award_amount| award_year| month_num|\n|:---------------------------------------------|:-------------------------------|:---------|:------------|:-----------------------------|:----------------|-----------:|---------------:|------------------:|----------:|---------:|\n|Accounting And Corporate Regulatory Authority |ACCENTURE SG SERVICES PTE. LTD. |agency_1  |supplier_103 |Engineering Procurement - EPC |STATUTORY_BOARDS |       24232|               1|            2035000|       2019|         4|\n|Accounting And Corporate Regulatory Authority |ACCENTURE SG SERVICES PTE. LTD. |agency_1  |supplier_103 |General Procurement - Goods   |STATUTORY_BOARDS |       24268|               1|          108555723|       2022|         4|\n|Accounting And Corporate Regulatory Authority |ALPHA ZETTA PTE. LTD.           |agency_1  |supplier_311 |General Procurement - Goods   |STATUTORY_BOARDS |       24261|               1|            2321600|       2021|         9|\n\n\n:::\n:::\n\n\n\n\n#### 4 Create Month Reference Table\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Create month reference table -----\nmonths_table <- network_labeled %>%\n  distinct(award_year, month_num, month_name, month_index, year_month) %>%\n  arrange(month_index) %>%\n  mutate(\n    display_label = paste0(month_name, \" \", award_year)\n  )\n\n# Create agency types reference table -----\nagency_types_df <- agency_nodes %>%\n  select(agency = name, agency_type) %>%\n  filter(!is.na(agency_type)) %>%\n  distinct()\n\n# Package everything -----\nnetwork_data <- list(\n  # Main network components\n  nodes = nodes_df,\n  edges = edges_df,\n\n  monthly_edges = monthly_edges_df,\n  months = months_table,\n  agency_types = agency_types_df,\n  time_info = list(\n    years = sort(unique(network_labeled$award_year)),\n    min_date = min(network_labeled$award_date, na.rm = TRUE),\n    max_date = max(network_labeled$award_date, na.rm = TRUE),\n    month_range = range(network_labeled$month_index, na.rm = TRUE)\n  )\n)\n```\n:::\n\n\n\n\n#### 5 Save to RDS file for use\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Save to RDS\n#saveRDS(network_data, \"m3_processed_network_data.rds\")\n```\n:::\n",
    "supporting": [
      "Data_Processing_Network_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
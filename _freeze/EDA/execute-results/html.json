{
  "hash": "e802785ac9b72bff7b12e0c9a5f9219c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"EDA\"\nauthor: \"Chang Fang Yu\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: True\n  eval: True\n  warning: false\n  freeze: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse, plotly, \n               DT, GGally, parallelPlot, tidytext) \npacman::p_load(igraph, tidygraph, ggraph, \n               visNetwork, lubridate, clock,\n               tidyverse, graphlayouts)\n```\n:::\n\n\n\n\n\nImport data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGP <- read_csv(\"data/GovernmentProcurementviaGeBIZ.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(GP)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 18,638\nColumns: 7\n$ tender_no            <chr> \"ACR000ETT18300010\", \"ACR000ETT18300011\", \"ACR000…\n$ tender_description   <chr> \"SUPPLY, DESIGN, DEVELOPMENT, CUSTOMIZATION, DELI…\n$ agency               <chr> \"Accounting And Corporate Regulatory Authority\", …\n$ award_date           <chr> \"11/6/2019\", \"10/5/2019\", \"30/4/2019\", \"29/8/2019…\n$ tender_detail_status <chr> \"Awarded to Suppliers\", \"Awarded to No Suppliers\"…\n$ supplier_name        <chr> \"AZAAS PTE. LTD.\", \"Unknown\", \"ACCENTURE SG SERVI…\n$ awarded_amt          <dbl> 2305880.0, 0.0, 2035000.0, 30700373.9, 178800.0, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(GP)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nspc_tbl_ [18,638 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ tender_no           : chr [1:18638] \"ACR000ETT18300010\" \"ACR000ETT18300011\" \"ACR000ETT19300001\" \"ACR000ETT19300002\" ...\n $ tender_description  : chr [1:18638] \"SUPPLY, DESIGN, DEVELOPMENT, CUSTOMIZATION, DELIVERY, INSTALLATION, TESTING, COMMISSIONING AND MAINTENANCE OF A\"| __truncated__ \"APPLICATION ENHANCEMENT, CUSTOMISATION, MIGRATION, DELIVERY, INSTALLATION, TESTING AND COMMISSIONING OF THE FUL\"| __truncated__ \"PROVISION OF CONSULTANCY SERVICES FOR STRATEGIC BUSINESS PROCESSES RE-ENGINEERING (SBPR) AND ACRA'S IT INFRASTRUCTURE\" \"SUPPLY, DELIVERY, DESIGN, CUSTOMISATION, INSTALLATION, CONFIGURATION, TESTING, COMMISSIONING OF A FULLY OPERATI\"| __truncated__ ...\n $ agency              : chr [1:18638] \"Accounting And Corporate Regulatory Authority\" \"Accounting And Corporate Regulatory Authority\" \"Accounting And Corporate Regulatory Authority\" \"Accounting And Corporate Regulatory Authority\" ...\n $ award_date          : chr [1:18638] \"11/6/2019\" \"10/5/2019\" \"30/4/2019\" \"29/8/2019\" ...\n $ tender_detail_status: chr [1:18638] \"Awarded to Suppliers\" \"Awarded to No Suppliers\" \"Awarded to Suppliers\" \"Awarded to Suppliers\" ...\n $ supplier_name       : chr [1:18638] \"AZAAS PTE. LTD.\" \"Unknown\" \"ACCENTURE SG SERVICES PTE. LTD.\" \"TECH MAHINDRA LIMITED (SINGAPORE BRANCH)\" ...\n $ awarded_amt         : num [1:18638] 2305880 0 2035000 30700374 178800 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   tender_no = col_character(),\n  ..   tender_description = col_character(),\n  ..   agency = col_character(),\n  ..   award_date = col_character(),\n  ..   tender_detail_status = col_character(),\n  ..   supplier_name = col_character(),\n  ..   awarded_amt = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(is.na(GP))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(GP)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  tender_no         tender_description    agency           award_date       \n Length:18638       Length:18638       Length:18638       Length:18638      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n tender_detail_status supplier_name       awarded_amt       \n Length:18638         Length:18638       Min.   :0.000e+00  \n Class :character     Class :character   1st Qu.:7.000e+03  \n Mode  :character     Mode  :character   Median :1.647e+05  \n                                         Mean   :5.540e+06  \n                                         3rd Qu.:8.227e+05  \n                                         Max.   :1.493e+09  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(GP)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"tender_no\"            \"tender_description\"   \"agency\"              \n[4] \"award_date\"           \"tender_detail_status\" \"supplier_name\"       \n[7] \"awarded_amt\"         \n```\n\n\n:::\n:::\n\n\n\n\nData Cleaning\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# drop NA\nGP_cleaned <- GP %>% drop_na()\n\n# Numeric type accuracy\nGP_cleaned <- GP_cleaned %>%\n  mutate(across(where(is.character), as.factor))  \n\nGP_cleaned <- GP_cleaned %>%\n  mutate(across(contains(\"Value\"), as.numeric, .names = \"numeric_{.col}\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nGP_summary <- GP %>%\n  group_by(agency) %>%\n  summarise(Total_Value = sum(awarded_amt, na.rm = TRUE)) %>%\n  arrange(desc(Total_Value))\n\nggplot(GP_summary, aes(x = reorder(agency, Total_Value), y = Total_Value)) +\n  geom_col(show.legend = FALSE) +\n  coord_flip() +\n  labs(title = \"Government Procurement via GeBIZ\",\n       x = \"Agency\",\n       y = \"Total Value\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\nTop 10 suppliers\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGP %>%\n  group_by(supplier_name) %>%\n  summarise(Count = n()) %>%\n  arrange(desc(Count)) %>%\n  head(10) %>%\n  ggplot(aes(x = reorder(supplier_name, Count), y = Count)) +\n  geom_col(fill = \"darkorange\") +\n  coord_flip() +\n  labs(title = \"Top 10 Suppliers with Most Awarded Tenders\",\n       x = \"Supplier Name\",\n       y = \"Number of Tenders\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidytext)\nlibrary(wordcloud)\n\n# Tokenization and word frequency calculation\nword_freq <- GP %>%\n  unnest_tokens(word, tender_description) %>%\n  count(word, sort = TRUE) %>%\n  filter(!word %in% stop_words$word) # Remove stopwords\n\n# Generate a word cloud\nwordcloud(words = word_freq$word, freq = word_freq$n, max.words = 100, colors = brewer.pal(8, \"Dark2\"))\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate total procurement amount per supplier\nsupplier_market_share <- GP %>%\n  group_by(supplier_name) %>%\n  summarise(Total_Awarded_Amt = sum(awarded_amt, na.rm = TRUE)) %>%\n  arrange(desc(Total_Awarded_Amt))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)  # Ensure this package is loaded\n\nsupplier_market_share %>%\n  head(10) %>%\n  ggplot(aes(x = reorder(supplier_name, Total_Awarded_Amt), y = Total_Awarded_Amt)) +\n  geom_col(fill = \"darkblue\") +\n  coord_flip() +\n  scale_y_continuous(labels = dollar_format(prefix = \"S$\")) +  # Fixing dollar_format\n  labs(title = \"Top 10 Suppliers by Procurement Amount\",\n       x = \"Supplier\",\n       y = \"Total Awarded Amount (S$)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Select top 10 suppliers and group others as \"Others\"\ntop_suppliers <- supplier_market_share %>%\n  head(10)\n\nother_suppliers <- tibble(\n  supplier_name = \"Others\",\n  Total_Awarded_Amt = sum(supplier_market_share$Total_Awarded_Amt) - sum(top_suppliers$Total_Awarded_Amt)\n)\n\n# Combine top suppliers and others\nsupplier_pie_data <- bind_rows(top_suppliers, other_suppliers)\n\n# Plot pie chart\nggplot(supplier_pie_data, aes(x = \"\", y = Total_Awarded_Amt, fill = supplier_name)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(\"y\", start = 0) +\n  scale_fill_manual(values = rainbow(11)) +  # Assign different colors\n  theme_void() +\n  labs(title = \"Market Share of Top 10 Suppliers in Government Procurement\")\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ensure supplier_market_share is sorted and compute cumulative sum\nsupplier_market_share <- supplier_market_share %>%\n  arrange(desc(Total_Awarded_Amt)) %>%   # Sort in descending order\n  mutate(Cumulative_Share = cumsum(Total_Awarded_Amt) / sum(Total_Awarded_Amt)) %>%  \n  mutate(Supplier_Rank = row_number())  # Precompute row numbers\n\n# Create a Cumulative Market Share Plot\nggplot(supplier_market_share, aes(x = Supplier_Rank, y = Cumulative_Share)) +\n  geom_line(color = \"red\", linewidth = 1) +   # Line for cumulative trend\n  geom_point(color = \"blue\") +                # Points for emphasis\n  scale_y_continuous(labels = percent_format()) +  # Convert Y-axis to percentage\n  labs(title = \"Cumulative Market Share of Suppliers\",\n       x = \"Number of Suppliers\",\n       y = \"Cumulative Market Share (%)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nDistribution of Awarded Amount (Boxplot)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGP %>%\n  ggplot(aes(y = awarded_amt)) +\n  geom_boxplot(fill = \"lightgreen\", outlier.color = \"red\") +\n  scale_y_continuous(labels = scales::comma) +\n  labs(title = \"Distribution of Awarded Amounts\",\n       y = \"Awarded Amount (S$)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\nTotal Procurement Amount by Government Agencies\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGP %>%\n  group_by(agency) %>%\n  summarise(Total_Awarded_Amt = sum(awarded_amt, na.rm = TRUE)) %>%\n  arrange(desc(Total_Awarded_Amt)) %>%\n  head(10) %>%\n  ggplot(aes(x = reorder(agency, Total_Awarded_Amt), y = Total_Awarded_Amt)) +\n  geom_col(fill = \"steelblue\") +\n  coord_flip() +\n  labs(title = \"Government Procurement Total Amount by Agency\",\n       x = \"Agency\",\n       y = \"Total Awarded Amount (S$)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](EDA_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "EDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}